OBJECT Page 5961 Service E-Mail Queue
{
  OBJECT-PROPERTIES
  {
    Date=28.03.13;
    Time=12:00:00;
    Version List=NAVW17.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Service E-Mail Queue;
               ESP=Cola correo electr¢nico servicio;
               DEA=Service-E-Mail-Warteschlange];
    InsertAllowed=No;
    SourceTable=Table5935;
    PageType=List;
    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 22      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Queue;
                                 ESP=&Cola;
                                 DEA=&Warteschlange];
                      Image=CheckList }
      { 23      ;2   ;Action    ;
                      CaptionML=[ENU=&Send E-Mail;
                                 ESP=E&nviar correo electr¢nico;
                                 DEA=&E-Mail senden];
                      Image=Email;
                      OnAction=BEGIN
                                 IF ISEMPTY THEN BEGIN
                                   ERROR(Text001);
                                   EXIT;
                                 END;

                                 IF Status = Status::Processed THEN
                                   ERROR(Text000);

                                 CLEAR(ServMailMgt);

                                 CLEARLASTERROR;

                                 IF ServMailMgt.RUN(Rec) THEN BEGIN
                                   Status := Status::Processed;
                                   CurrPage.UPDATE;
                                 END ELSE BEGIN
                                   ERROR(GETLASTERRORTEXT);
                                   CLEARLASTERROR;
                                 END;
                               END;
                                }
      { 24      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Delete Service Order E-Mail Queue;
                                 ESP=&Eliminar cola correo electr¢nico ped. serv.;
                                 DEA=Servi&ceauftrags-E-Mail-Warteschlange l”schen];
                      Image=Delete;
                      OnAction=VAR
                                 EMailQueue@1000 : Record 5935;
                               BEGIN
                                 CLEAR(EMailQueue);
                                 EMailQueue.SETCURRENTKEY("Document Type","Document No.");
                                 EMailQueue.SETRANGE("Document Type","Document Type");
                                 EMailQueue.SETRANGE("Document No.","Document No.");
                                 REPORT.RUN(REPORT::"Delete Service E-Mail Queue",FALSE,FALSE,EMailQueue);
                               END;
                                }
      { 16      ;2   ;Action    ;
                      CaptionML=[ENU=D&elete Service E-Mail Queue;
                                 ESP=El&iminar cola correo electr¢nico servicio;
                                 DEA=Service-E-Mail-Warteschlange &l”schen];
                      Image=Delete;
                      OnAction=BEGIN
                                 REPORT.RUNMODAL(REPORT::"Delete Service E-Mail Queue");
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 14  ;2   ;Field     ;
                SourceExpr="Document Type";
                Editable=FALSE }

    { 21  ;2   ;Field     ;
                SourceExpr="Document No.";
                Editable=FALSE }

    { 4   ;2   ;Field     ;
                SourceExpr=Status }

    { 10  ;2   ;Field     ;
                SourceExpr="Sending Date";
                Editable=FALSE }

    { 12  ;2   ;Field     ;
                SourceExpr="Sending Time";
                Editable=FALSE }

    { 2   ;2   ;Field     ;
                SourceExpr="To Address" }

    { 8   ;2   ;Field     ;
                SourceExpr="Subject Line" }

    { 6   ;2   ;Field     ;
                SourceExpr="Body Line";
                Visible=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=The program has already sent this e-mail.;ESP=El programa ya ha enviado este correo electr¢nico.;DEA=Diese E-Mail wurde bereits gesendet.';
      Text001@1002 : TextConst 'ENU=There are no items to process.;ESP=No hay ning£n producto para procesar.;DEA=Es sind keine zu verarbeitenden Artikel vorhanden.';
      ServMailMgt@1001 : Codeunit 5916;

    BEGIN
    END.
  }
}

